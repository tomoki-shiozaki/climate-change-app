@startuml system_architecture
skinparam defaultFontName "Noto Sans CJK JP"
left to right direction

actor User
actor Developer

package "GitHub" {
  component "GitHub Repository" as GitHubRepo
}

package "Render" {
  component "React Frontend" as Frontend
}

package "Google Cloud" {
  component "Cloud Build" as CloudBuild
  component "Artifact Registry" as ArtifactRegistry
  component "Cloud Run (DRF Backend)" as CloudRun
  component "Cloud Logging" as Logging
  component "Secret Manager" as SecretManager
}

package "Neon" {
  component "Neon PostgreSQL" as NeonPostgreSQL
}

package "External APIs" {
  component "Climate Data API" as ClimateAPI
}

' 開発からデプロイ
Developer --> GitHubRepo : Push Code
GitHubRepo --> CloudBuild : Trigger CI/CD (Backend)
CloudBuild --> ArtifactRegistry : Push Container Image
CloudBuild --> CloudRun : Deploy Image
ArtifactRegistry --> CloudRun : Pull Image

GitHubRepo --> Frontend : Trigger Deploy (Render)

' シークレット管理
CloudRun --> SecretManager : Fetch Secrets

' アプリ実行
User --> Frontend : HTTP Request
Frontend --> CloudRun : API Request
CloudRun --> NeonPostgreSQL : DB Access
CloudRun --> ClimateAPI : Fetch Climate Data
CloudRun ..> Logging : Send Logs

@enduml
